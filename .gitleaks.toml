# Gitleaks Configuration
# https://github.com/gitleaks/gitleaks

title = "ROSA Terraform Gitleaks Config"

[extend]
# Use the default gitleaks config as base
useDefault = true

#------------------------------------------------------------------------------
# Custom Rules
#------------------------------------------------------------------------------

[[rules]]
id = "openshift-token"
description = "OpenShift OAuth Token"
regex = '''sha256~[A-Za-z0-9_-]{43}'''
tags = ["token", "openshift"]

#------------------------------------------------------------------------------
# Allowlist - Files and Patterns to Ignore
#------------------------------------------------------------------------------

[allowlist]
description = "Global allowlist"

# Files to ignore
paths = [
  '''.gitleaks.toml''',
  '''.pre-commit-config.yaml''',
  '''\.md$''',
  '''go\.sum$''',
  '''package-lock\.json$''',
]

# Patterns that are safe (example tokens, placeholders, demo AWS account IDs)
regexes = [
  '''<your-.*>''',
  '''YOUR_.*_HERE''',
  '''PLACEHOLDER''',
  '''example\.com''',
  '''xxx+''',
  '''sha256~[xX]+''',
  # Placeholder AWS account ID used in example ARNs throughout tfvars and variable defaults
  '''123456789012''',
  # Placeholder KMS key UUID used in example ARNs
  '''12345678-1234-1234-1234-123456789012''',
]
